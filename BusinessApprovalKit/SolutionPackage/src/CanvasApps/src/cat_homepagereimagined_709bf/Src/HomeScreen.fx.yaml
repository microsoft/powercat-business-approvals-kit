HomeScreen As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: =

    MainContainer As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Fill: =RGBA(245, 245, 245, 1)
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        PaddingLeft: =20
        PaddingRight: =20
        PaddingTop: =20
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =App.Width
        ZIndex: =2

        RootContainer As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.Regular
            Fill: |-
                =ColorValue("#ffffff")
            FillPortions: =0
            Height: =HeaderRootContainer.Height + ApprovalOptionContainer.Height + MySubmittedWorkflowContainer.Height + ReceivedApprovalRequests.Height + Self.PaddingTop + Parent.PaddingTop + Self.LayoutGap
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =20
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Width: =App.Width
            ZIndex: =1

            HeaderRootContainer As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =ColorValue(AppTheme.palette.white)
                FillPortions: =0
                Height: =180
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                PaddingLeft: =40
                PaddingRight: =40
                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                ZIndex: =2

                imgHeader As image:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Height: =Parent.Height
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Image: =Banner
                    ImagePosition: =ImagePosition.Fill
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    RadiusBottomLeft: =25
                    RadiusBottomRight: =25
                    RadiusTopLeft: =25
                    RadiusTopRight: =25
                    Width: =Parent.Width - (2 * Self.X)
                    X: =40
                    ZIndex: =1

                AKHeader As groupContainer.horizontalAutoLayoutContainer:
                    Height: =180
                    LayoutMode: =LayoutMode.Auto
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Width: =Parent.Width
                    ZIndex: =5

                    AKHeaderTextContainer As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Height: =180
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =500
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =5
                        PaddingLeft: =40
                        PaddingRight: =40
                        PaddingTop: =20
                        Width: =Parent.Width
                        ZIndex: =1

                        Container1 As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =50
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            RadiusBottomLeft: =4
                            RadiusBottomRight: =4
                            RadiusTopLeft: =4
                            RadiusTopRight: =4
                            ZIndex: =3

                            "AutoWidthLabel1 As 'Auto Width Label (1.0.22)'":
                                DisplayMode: =DisplayMode.Edit
                                FontSize: =22
                                FontWeight: ="800"
                                Height: =50
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                Text: =Title
                                Visible: =true
                                Width: =Max(Self.AutoWidth + 10, 110)
                                X: =0
                                Y: =0
                                ZIndex: =1

                            lblMaturity As Label:
                                AlignInContainer: =AlignInContainer.Start
                                Alignment: =Align.Justify
                                Color: =RGBA(0, 120, 212, 1)
                                DisplayMode: =DisplayMode.Edit
                                FillPortions: =1
                                Height: =32
                                LayoutMinHeight: =32
                                LayoutMinWidth: =320
                                Text: =Experimental
                                VerticalAlignment: ="middle"
                                Visible: =false
                                Width: =320
                                X: =40
                                Y: =40
                                ZIndex: =2

                        lblSubtext As Label:
                            Alignment: =Align.Justify
                            AutoHeight: =false
                            Color: =    
                            DisplayMode: =DisplayMode.View
                            FontSize: =14
                            FontWeight: =FontWeight.Semibold
                            Height: =70
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            Text: =Subtitle
                            TextRole: ='Label.TextRole'.Heading1
                            VerticalAlignment: =VerticalAlign.Top
                            Width: =Min(550,Parent.Width - Parent.PaddingLeft - Parent.PaddingRight)
                            Wrap: =true
                            X: =54
                            Y: =Container1.Height+Container1.Y
                            ZIndex: =5

            ApprovalOptionContainer As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =NewFeaturesContainer.Height + FeaturedGallery.Height 
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =30
                PaddingRight: =30
                Width: |
                    =Min(1300, Parent.Width)   
                ZIndex: =3

                NewFeaturesContainer As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =40
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =20
                    PaddingRight: =10
                    ZIndex: =1

                    lblNewFeatureHeader As Label:
                        AutoHeight: =true
                        Color: =RGBA(0, 0, 0, 1)
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =12
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        LayoutMinHeight: =32
                        LayoutMinWidth: =320
                        PaddingStart: =0
                        Text: =NewFeatures
                        Width: =320
                        X: =35
                        Y: =15
                        ZIndex: =1

                FeaturedGallery As gallery.galleryHorizontal:
                    AccessibleLabel: ="Available options"
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(166, 166, 166, 1)
                    FillPortions: =0
                    FocusedBorderColor: =RGBA(0, 120, 212, 1)
                    FocusedBorderThickness: =2
                    Height: =170 * Switch(LookUp(App.SizeBreakpoints, Value > App.Width).Value, 1200, 1, 900, 2, 600, 3, 1)
                    Items: |-
                        =Table(
                        {
                         Title:"Configure a workflow",
                         Body:"Learn how to configure a new workflow with approvals kit",
                         Learn:"",
                         LearnMoreLabel:"Learn more",
                         ActionLabel:"New workflow",
                         Type:"ApprovalAction",
                         LearnMoreIconName:"OpenInNewWindow",
                         ActionIconName:"Add",
                         DisplayMode:DisplayMode.Edit
                        },
                        {
                         Title:"Link a workflow with another system",
                         Body:"Learn how to link your workflow to work with another system using Power Automate",
                         Learn:"https://aka.ms/business-approvals-templates-docs",
                         LearnMoreLabel:"Learn more",
                         ActionLabel:"",
                         Type:"ApprovalAction",
                         LearnMoreIconName:"OpenInNewWindow",
                         ActionIconName:"",
                         DisplayMode:DisplayMode.Edit
                        },
                        {
                         Title:"Configure basic settings",
                         Body:"Learn how to link your delegation, out of office and more",
                         Learn:"https://aka.ms/business-approvals-templates-docs",
                         LearnMoreLabel:"Learn more",
                         ActionLabel:"Settings page",
                         Type:"ApprovalAction",
                         LearnMoreIconName:"OpenInNewWindow",
                         ActionIconName:"Settings",
                         DisplayMode:DisplayMode.Edit
                        })
                    LayoutMinHeight: =220
                    LayoutMinWidth: =320
                    ShowScrollbar: =false
                    TabIndex: =0
                    TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(320, Self.Width - 60), Min(320, Self.Height - 60))
                    Width: =Parent.Width
                    WrapCount: =Switch(LookUp(App.SizeBreakpoints, Value > App.Width).Value, 1200, 1, 900, 2, 600, 3, 1)
                    Y: =450
                    ZIndex: =3

                    "CardElevation As 'Fluent Elevation (1.0.22)'":
                        DisplayMode: =DisplayMode.Edit
                        Height: =160
                        HoverDepth: ='PowerCAT.Elevation.HoverDepth'.Depth8
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =1

                    CardInnerContainer As groupContainer.verticalAutoLayoutContainer:
                        Height: =160
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =16
                        PaddingLeft: =20
                        PaddingRight: =20
                        PaddingTop: =10
                        Width: =320
                        ZIndex: =2

                        CardTitleContainer As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =32
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =1

                            lblCardTitle As Label:
                                Alignment: =Align.Justify
                                DisplayMode: =DisplayMode.Edit
                                FontSize: =11
                                FontWeight: =FontWeight.Semibold
                                Height: =32
                                LayoutMinHeight: =32
                                LayoutMinWidth: =320
                                Text: =If(ThisItem.Title <> "Label", ThisItem.Title)
                                TextRole: ='Label.TextRole'.Heading1
                                VerticalAlignment: =VerticalAlign.Middle
                                Width: =250
                                X: =0
                                Y: =0
                                ZIndex: =2

                        "CardTagList As 'Fluent Tag List (1.0.22)'.pcfdataset":
                            DisplayMode: =DisplayMode.Edit
                            Height: =34
                            ItemDisplayName: ="ItemDisplayName"
                            Items: |-
                                =Table({ItemKey:"experimental", ItemDisplayName:"Configure a workflow"})
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            Visible: =false
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =2

                            ItemDisplayName1 As pcfDataField.textualColumn:
                                FieldDisplayName: ="ItemDisplayName"
                                FieldName: ="ItemDisplayName"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =1
                                ZIndex: =6

                            ItemKey1 As pcfDataField.textualColumn:
                                FieldDisplayName: ="ItemKey"
                                FieldName: ="ItemKey"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =2
                                ZIndex: =7

                        lbCardDescription As Label:
                            AutoHeight: =false
                            Color: =    
                            DisplayMode: =DisplayMode.View
                            FontSize: =10
                            FontWeight: =FontWeight.Normal
                            Height: =70
                            LayoutMinHeight: =32
                            LayoutMinWidth: =250
                            Text: =If(ThisItem.Body <> "Label", ThisItem.Body)
                            VerticalAlignment: =VerticalAlign.Top
                            Width: =320
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =3

                        rectCardDivider As rectangle:
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledFill: =RGBA(166, 166, 166, 1)
                            Fill: =RGBA(225, 223, 221, 1)
                            FocusedBorderColor: =RGBA(0, 120, 212, 1)
                            Height: =1
                            HoverFill: =RGBA(225, 223, 221, 1)
                            PressedFill: =RGBA(225, 223, 221, 1)
                            Width: =1366
                            Y: =72
                            ZIndex: =4

                        CardActionContainer As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =35
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingTop: =5
                            ZIndex: =5

                            "LeanMoreIcon As 'Fluent Icon (1.0.22)'":
                                DisplayMode: =ThisItem.DisplayMode
                                FontColor: =
                                FontSize: =14
                                Height: =33
                                IconName: =ThisItem.LearnMoreIconName
                                IconType: ='PowerCAT.Icon.IconType'.ActionButton
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: =Launch(ThisItem.Learn)
                                Text: =ThisItem.LearnMoreLabel
                                Theme: =AppThemeJson
                                Tooltip: ="Learn more"
                                Visible: =!IsBlank(ThisItem.LearnMoreLabel)
                                Width: =145
                                X: =0
                                Y: =0
                                ZIndex: =2

                            "CreateActionIcon As 'Fluent Icon (1.0.22)'":
                                DisplayMode: =DisplayMode.Edit
                                FontColor: =
                                FontSize: =14
                                Height: =33
                                IconName: =ThisItem.ActionIconName
                                IconSize: =17
                                IconType: ='PowerCAT.Icon.IconType'.ActionButton
                                LayoutMinHeight: =200
                                LayoutMinWidth: =200
                                OnChange: |-
                                    =Switch(ThisItem.ActionLabel,"New workflow", UpdateContext({_Navigate:true}),"Settings page",Navigate(Settings));
                                Text: =ThisItem.ActionLabel
                                Theme: =AppThemeJson
                                Tooltip: =ThisItem.ActionLabel
                                Visible: =!IsBlank(ThisItem.ActionLabel)
                                Width: =140
                                X: =0
                                Y: =0
                                ZIndex: =3

            MySubmittedWorkflowContainer As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =SubmittedWorkflowHeaderContiner.Height + FluentDetailsListSubmittedWorkflows.Height
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =40
                PaddingRight: =40
                Width: |
                    =Min(1300, Parent.Width)   
                ZIndex: =4

                SubmittedWorkflowHeaderContiner As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =40
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =10
                    PaddingRight: =10
                    ZIndex: =1

                    lblSubmittedWorkflow As Label:
                        AutoHeight: =true
                        Color: =RGBA(0, 0, 0, 1)
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =12
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        LayoutMinHeight: =32
                        LayoutMinWidth: =320
                        PaddingStart: =0
                        Text: =SubmittedWorkflowTitle
                        Width: =320
                        X: =35
                        Y: =15
                        ZIndex: =1

                SubmittedRequestsContainer As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.Light
                    FillPortions: =0
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    ZIndex: =3

                    "FluentDetailsListSubmittedWorkflows As 'Fluent Details List (1.0.22)'.pcfdataset":
                        ColSortable: =""
                        columns_Items: |
                            =FirstN(Table(
                                {ColName:"cat_name",ColDisplayName:"Name",ColCellType:"link",ColWidth:350,ColSortable:true,ColResizable:true,ColRowHeader:true},
                                {ColName:"cat_ProcessVersion",ColDisplayName:"Process",ColWidth:200,ColSortable:true,ColResizable:true,ColRowHeader:true},
                                {ColName:"cat_version",ColDisplayName:"Project Version Number",ColWidth:200,ColSortable:true,ColResizable:true,ColRowHeader:true},
                                {ColName:"createdby",ColDisplayName:"Created By",ColWidth:Self.Width-850,ColSortable:true,ColResizable:true,ColRowHeader:true}
                            ),5)
                        CurrentSortColumn: =ctxSortCol
                        CurrentSortDirection: |-
                            =If(ctxSortAsc,
                                'PowerCAT.FluentDetailsList.CurrentSortDirection'.Ascending,
                                'PowerCAT.FluentDetailsList.CurrentSortDirection'.Descending)
                        DisplayMode: =DisplayMode.Edit
                        Height: =220
                        InputEvent: =
                        Items: =FirstN('Business Approval Workflows',5)
                        LargeDatasetPaging: =false
                        OnChange: |-
                            =If(Self.EventName="CellAction",
                            // Navigate to corresponding form depending upon column/link selected
                            UpdateContext({SelectedBAWRecord:LookUp('Business Approval Workflows','Business Approval Workflow' = GUID(Self.EventRowKey))});
                            Switch(Self.EventColumn,
                            "cat_name",
                            Navigate(SelectedBAWRecord, { Page: 'Business Approval Workflows (Forms)'.Information}),
                            "cat_ProcessVersion",
                            Navigate(LookUp('Business Approval Versions', 'Business Approval Version' = SelectedBAWRecord.'Process Version'.'Business Approval Version'), { Page: 'Business Approval Versions (Forms)'.Information}),
                            "createdby",
                            Navigate(LookUp(Users, User = SelectedBAWRecord.'Created By'.User), { Page: 'Users (Forms)'.Information})));
                            
                            //Sorting logic
                            If(Self.EventName="Sort", 
                            Set(ctxSortCol,Self.SortEventColumn);
                            Set(ctxSortAsc,If(Self.SortEventDirection='PowerCAT.FluentDetailsList.SortEventDirection'.Ascending,true,false));
                            );
                        OnSelect: =Notify("OnSelect " & Self.EventRowKey)
                        PageSize: =5
                        RaiseOnRowSelectionChangeEvent: =true
                        RecordCanSelect: =
                        RecordKey: ="cat_businessapprovalworkflowid"
                        SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
                        SelectRowsOnFocus: =
                        Theme: =AppThemeJson
                        Visible: =true
                        Width: =Parent.Width
                        X: =0
                        Y: =0
                        ZIndex: =3

                        Name1 As pcfDataField.textualColumn:
                            FieldDisplayName: ="Name"
                            FieldName: ="cat_name"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =23

                        "'Process Version Number1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Process Version Number"
                            FieldName: ="cat_version"
                            FieldType: ="n"
                            FieldVariantName: ="textualColumn"
                            Order: =3
                            ZIndex: =24

                        "'Created By1' As pcfDataField":
                            FieldDisplayName: ="Created By"
                            FieldName: ="createdby"
                            FieldType: ="E"
                            FieldVariantName: ="complexTypeColumn"
                            Order: =4
                            ZIndex: =25

                        "'Created On1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Created On"
                            FieldName: ="createdon"
                            FieldType: ="d"
                            FieldVariantName: ="textualColumn"
                            Order: =5
                            ZIndex: =26

                        "'Modified On1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Modified On"
                            FieldName: ="modifiedon"
                            FieldType: ="d"
                            FieldVariantName: ="textualColumn"
                            Order: =6
                            ZIndex: =27

                        "'Process Version1' As pcfDataField":
                            FieldDisplayName: ="Process Version"
                            FieldName: ="cat_ProcessVersion"
                            FieldType: ="E"
                            FieldVariantName: ="complexTypeColumn"
                            Order: =6
                            ZIndex: =28

                        "'Business Approval Workflow1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Business Approval Workflow"
                            FieldName: ="cat_businessapprovalworkflowid"
                            FieldType: ="g"
                            FieldVariantName: ="textualColumn"
                            Order: =7
                            ZIndex: =29

            ReceivedApprovalRequests As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =SubmittedWorkflowHeaderContiner_1.Height + FluentDetailsListApprovalRequest.Height + 20
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =40
                PaddingRight: =40
                Width: |
                    =Min(1300, Parent.Width)   
                ZIndex: =5

                SubmittedWorkflowHeaderContiner_1 As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =40
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =10
                    PaddingRight: =10
                    ZIndex: =1

                    lblReceivedApprovalRequest As Label:
                        AutoHeight: =true
                        Color: =RGBA(0, 0, 0, 1)
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =12
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        LayoutMinHeight: =32
                        LayoutMinWidth: =320
                        PaddingStart: =0
                        Text: =ReceivedApprovalRequestTitle
                        Width: =320
                        X: =35
                        Y: =15
                        ZIndex: =1

                ApprovalRequestsContainer As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.Light
                    FillPortions: =0
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    ZIndex: =4

                    "FluentDetailsListApprovalRequest As 'Fluent Details List (1.0.22)'.pcfdataset":
                        columns_Items: |
                            =Table(
                                {ColName:"cat_name",ColDisplayName:"Instance No.",ColCellType:"link",ColWidth:200,ColSortable:true,ColResizable:true,ColRowHeader:true},
                                {ColName:"cat_Approver",ColDisplayName:"Approver",ColWidth:200,ColSortable:true,ColResizable:true,ColRowHeader:true},
                                {ColName:"cat_Stage",ColDisplayName:"Stage",ColWidth:150,ColSortable:true,ColResizable:true,ColRowHeader:true},
                                {ColName:"cat_Node",ColDisplayName:"Node",ColWidth:150, ColSortable:true,ColResizable:true,ColRowHeader:true}, 
                                {ColName:"cat_OriginalApprover",ColDisplayName:"Original Approver",ColWidth:150, ColSortable:true,ColResizable:true},
                                 {ColName:"cat_Notification",ColDisplayName:"Notification",ColWidth:200, ColSortable:true,ColResizable:true},
                                {ColName:"cat_additionalinformation",ColDisplayName:"Additional Information",ColWidth:200, ColSortable:true,ColResizable:true,ColRowHeader:true},
                                 {ColName:"cat_InstanceStatus",ColDisplayName:"Instance Status",ColWidth:200,ColSortable:true,ColResizable:true,ColRowHeader:true}
                            )
                        CurrentSortColumn: =ctxSortCol
                        CurrentSortDirection: |-
                            =If(ctxSortAsc,
                                'PowerCAT.FluentDetailsList.CurrentSortDirection'.Ascending,
                                'PowerCAT.FluentDetailsList.CurrentSortDirection'.Descending)
                        DisplayMode: =DisplayMode.Edit
                        Height: =220
                        InputEvent: =
                        Items: =FirstN('Business Approval Instances',5)
                        LargeDatasetPaging: =false
                        OnChange: |-
                            =If(Self.EventName="CellAction",
                            // Navigate to corresponding form depending upon column/link selected
                            UpdateContext({SelectedBAIRecord:LookUp('Business Approval Instances','Business Approval Instance' = GUID(Self.EventRowKey))});
                            Switch(Self.EventColumn,
                            "cat_name",
                            Navigate(SelectedBAIRecord, { Page: 'Business Approval Instances (Forms)'.Information}),
                            "cat_OriginalApprover",
                            Navigate(LookUp('Business Approvers', 'Business Approver' = SelectedBAIRecord.'Original Approver'.'Business Approver'), { Page: 'Business Approvers (Forms)'.Information}),
                            "cat_Approver",
                            Navigate(LookUp('Business Approvers', 'Business Approver' = SelectedBAIRecord.Approver.'Business Approver'), { Page: 'Business Approvers (Forms)'.Information}),
                            "cat_Stage",
                            Navigate(LookUp('Business Approval Runtime Stages', 'Business Approval Runtime Stage' = SelectedBAIRecord.Stage.'Business Approval Runtime Stage'), { Page: 'Business Approval Runtime Stages (Forms)'.Information}),
                            "cat_Node",
                            Navigate(LookUp('Business Approval Runtime Nodes', 'Business Approval Runtime Node' = SelectedBAIRecord.Node.'Business Approval Runtime Node'), { Page: 'Business Approval Runtime Nodes (Forms)'.Information})));
                            
                            // Sorting logic
                            If(Self.EventName="Sort", 
                            Set(ctxSortCol,Self.SortEventColumn);
                            Set(ctxSortAsc,If(Self.SortEventDirection='PowerCAT.FluentDetailsList.SortEventDirection'.Ascending,true,false)));
                        OnSelect: =Notify("OnSelect " & Self.EventRowKey)
                        PageSize: =5
                        RecordKey: ="cat_businessapprovalinstanceid"
                        SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
                        Theme: =AppThemeJson
                        Visible: =true
                        Width: =Parent.Width
                        X: =0
                        Y: =0
                        ZIndex: =2

                        "'Instance No1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Instance No"
                            FieldName: ="cat_name"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =14

                        Notification1 As pcfDataField.textualColumn:
                            FieldDisplayName: ="Notification"
                            FieldName: ="cat_notification"
                            FieldType: |-
                                ="*[Value:l]"
                            FieldVariantName: ="textualColumn"
                            Order: =5
                            ZIndex: =15

                        "'Instance Status1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Instance Status"
                            FieldName: ="cat_instancestatus"
                            FieldType: ="l"
                            FieldVariantName: ="textualColumn"
                            Order: =8
                            ZIndex: =17

                        "'Created On2' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Created On"
                            FieldName: ="createdon"
                            FieldType: ="d"
                            FieldVariantName: ="textualColumn"
                            Order: =9
                            ZIndex: =18

                        Approver1 As pcfDataField:
                            FieldDisplayName: ="Approver"
                            FieldName: ="cat_Approver"
                            FieldType: ="E"
                            FieldVariantName: ="complexTypeColumn"
                            Order: =6
                            ZIndex: =19

                        Stage1 As pcfDataField:
                            FieldDisplayName: ="Stage"
                            FieldName: ="cat_Stage"
                            FieldType: ="E"
                            FieldVariantName: ="complexTypeColumn"
                            Order: =7
                            ZIndex: =20

                        "'Original Approver1' As pcfDataField":
                            FieldDisplayName: ="Original Approver"
                            FieldName: ="cat_OriginalApprover"
                            FieldType: ="E"
                            FieldVariantName: ="complexTypeColumn"
                            Order: =8
                            ZIndex: =21

                        Node1 As pcfDataField:
                            FieldDisplayName: ="Node"
                            FieldName: ="cat_Node"
                            FieldType: ="E"
                            FieldVariantName: ="complexTypeColumn"
                            Order: =9
                            ZIndex: =22

                        "'Business Approval Instance1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Business Approval Instance"
                            FieldName: ="cat_businessapprovalinstanceid"
                            FieldType: ="g"
                            FieldVariantName: ="textualColumn"
                            Order: =10
                            ZIndex: =30

                        "'Additional Information1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Additional Information"
                            FieldName: ="cat_additionalinformation"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =10
                            ZIndex: =31

