scrProcessEditor As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |-
        =With({ default: Lower(_selectedProcess.'Business Owner Email') }, 
            If(!IsBlank(default), UpdateContext({_selectedBusinessOwner:AddColumns(
                Office365Users.SearchUser({searchTerm: default, top:1}),
                "PersonaKey", Mail, 
                "PersonaName", DisplayName,
                "PersonaRole", JobTitle)}
                )
            )
        );
        
        With({ default: _selectedProcess.'Secondary Owner Email' }, 
            If(!IsBlank(default), UpdateContext({_selectedSecondaryOwner:AddColumns(
                Office365Users.SearchUser({searchTerm: default, top:1}),
                "PersonaKey", Mail, 
                "PersonaName", DisplayName,
                "PersonaRole", JobTitle)}
                )
            )
        );
        
        With({ default: _selectedProcess.'Default Approver Email' }, 
            If(!IsBlank(default), UpdateContext({_selectedDefaultApprover:AddColumns(
                Office365Users.SearchUser({searchTerm: default, top:1}),
                "PersonaKey", Mail, 
                "PersonaName", DisplayName,
                "PersonaRole", JobTitle)}
                )
            )
        );

    Container1_2 As groupContainer:
        Height: =Parent.Height - Self.Y
        Width: =Parent.Width - Self.X
        ZIndex: =1

        frmProcess As form:
            AcceptsFocus: =false
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =1
            DataSource: ='Business Approval Processes'
            Height: =250
            Item: =_selectedProcess
            OnSuccess: |-
                =Set(_selectedProcess, Self.LastSubmit);
                
                //add default approver into approver table if does not exist
                If(!IsBlank(First(PeoplePicker3.SelectedPeople).PersonaName),
                    With({ default: LookUp('Business Approvers', 'Approver Id' = _selectedProcess.'Default Approver Email')},
                        Set(_selectedProcess, 
                            Patch('Business Approval Processes', _selectedProcess, 
                            { 
                                'Default Approver': If(IsBlank(default),Patch('Business Approvers', Defaults('Business Approvers'),
                                { 
                                    'Approver Id': _selectedProcess.'Default Approver Email', 
                                    Name: _selectedProcess.'Default Approver Display Name',
                                    'Approver Type': 'Business Approver Type'.User 
                                }), default)
                            })
                        )
                    )
                );
                EditForm(frmProcess);
                Notify("Process saved succcessfully.", NotificationType.Success);
                Set(_isBusy, false)
            Width: =Max(Parent.Width - Self.X - 8, 980)
            X: =8
            Y: =CommandBar2_4.Y + CommandBar2_4.Height + 8
            ZIndex: =1

            "'Default Approver Display Name_DataCard2' As typedDataCard.textualEditCard":
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cat_defaultapproverdisplayname"
                Default: =ThisItem.'Default Approver Display Name'
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Default Approver"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@'Business Approval Processes'], DataSourceInfo.MaxLength, "cat_defaultapproverdisplayname")
                Required: =false
                Update: =First(PeoplePicker3.SelectedPeople).PersonaName
                Width: =383
                X: =2
                Y: =1
                ZIndex: =1

                DataCardKey13 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    PaddingLeft: =0
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                ErrorMessage11 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =9
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =PeoplePicker3.Y + PeoplePicker3.Height
                    ZIndex: =3

                StarVisible11 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey13.Height
                    PaddingLeft: =0
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey13.Y
                    ZIndex: =4

                "PeoplePicker3 As 'Fluent PeoplePicker (1.0.22) Preview'.pcfdataset":
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    Items: |-
                        =If(!IsBlank(_selectedProcess.'Default Approver Email'),
                            AddColumns(
                                Office365Users.SearchUser({searchTerm: _selectedProcess.'Default Approver Email', top:1}),
                                "PersonaKey", Mail, 
                                "PersonaName", DisplayName,
                                "PersonaRole", JobTitle)
                        )
                    MaxPeople: =1
                    OnSearch: |-
                        =ClearCollect(
                            UserCollection,
                            AddColumns(
                            Office365Users.SearchUser({ searchTerm: Self.SearchText, top: 500 }),
                            "SuggestionKey", Mail, 
                            "SuggestionName", DisplayName,
                            "SuggestionRole", JobTitle
                        )
                        )
                    Suggestions_Items: =UserCollection
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =40
                    ZIndex: =6

            "'Business Owner Email_DataCard1' As typedDataCard.textualEditCard":
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cat_businessowneremail"
                Default: =ThisItem.'Business Owner Email'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Business Approval Processes'],DataSourceInfo.DisplayName,"cat_businessowneremail")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@'Business Approval Processes'], DataSourceInfo.MaxLength, "cat_businessowneremail")
                Required: =false
                Update: |-
                    =//cboBusinessOwner.Selected.UserPrincipalName
                    First(PeoplePicker1.SelectedPeople).PersonaKey
                Visible: =false
                Width: =383
                X: =2
                Y: =2
                ZIndex: =1

            "'Secondary Owner Email_DataCard1' As typedDataCard.textualEditCard":
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cat_secondaryowneremail"
                Default: =ThisItem.'Secondary Owner Email'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Business Approval Processes'],DataSourceInfo.DisplayName,"cat_secondaryowneremail")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@'Business Approval Processes'], DataSourceInfo.MaxLength, "cat_secondaryowneremail")
                Required: =false
                Update: =First(PeoplePicker2.SelectedPeople).PersonaKey
                Visible: =false
                Width: =383
                X: =0
                Y: =3
                ZIndex: =1

            "'Default Approver Email_DataCard1' As typedDataCard.textualEditCard":
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cat_defaultapproveremail"
                Default: =ThisItem.'Default Approver Email'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Business Approval Processes'],DataSourceInfo.DisplayName,"cat_defaultapproveremail")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@'Business Approval Processes'], DataSourceInfo.MaxLength, "cat_defaultapproveremail")
                Required: =false
                Update: =First(PeoplePicker3.SelectedPeople).PersonaKey
                Visible: =false
                Width: =383
                X: =1
                Y: =3
                ZIndex: =1

            Name_DataCard1 As typedDataCard.textualEditCard:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cat_name"
                Default: =ThisItem.Name
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Name"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =83
                MaxLength: =DataSourceInfo([@'Business Approval Processes'], DataSourceInfo.MaxLength, "cat_name")
                Required: =true
                Update: =DataCardValue1.Text
                Width: =383
                X: =0
                Y: =0
                ZIndex: =3

                DataCardKey1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =27
                    PaddingLeft: =0
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue1 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Color: =RGBA(51, 51, 51, 1)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =30
                    HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(255, 255, 255, 1)
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    PressedBorderColor: =RGBA(105, 121, 126, 1)
                    PressedColor: =RGBA(51, 51, 51, 1)
                    PressedFill: =RGBA(255, 255, 255, 1)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey1.Y + DataCardKey1.Height + 5
                    ZIndex: =2

                ErrorMessage1 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue1.Y + DataCardValue1.Height
                    ZIndex: =3

                StarVisible1 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey1.Height
                    PaddingLeft: =0
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey1.Y
                    ZIndex: =4

            Category_DataCard1 As typedDataCard.textualEditCard:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cat_category"
                Default: =ThisItem.Category
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Category"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =83
                MaxLength: =DataSourceInfo([@'Business Approval Processes'], DataSourceInfo.MaxLength, "cat_category")
                Required: =false
                Update: =DataCardValue2.Text
                Width: =383
                X: =1
                Y: =0
                ZIndex: =3

                DataCardKey2 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =27
                    PaddingLeft: =0
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue2 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Color: =RGBA(51, 51, 51, 1)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =30
                    HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(255, 255, 255, 1)
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    PressedBorderColor: =RGBA(105, 121, 126, 1)
                    PressedColor: =RGBA(51, 51, 51, 1)
                    PressedFill: =RGBA(255, 255, 255, 1)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey2.Y + DataCardKey2.Height + 5
                    ZIndex: =2

                ErrorMessage2 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue2.Y + DataCardValue2.Height
                    ZIndex: =3

                StarVisible2 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey2.Height
                    PaddingLeft: =0
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey2.Y
                    ZIndex: =4

            Description_DataCard1 As typedDataCard.textualMultiLineEditCard:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cat_description"
                Default: =ThisItem.Description
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Description"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =83
                Required: =false
                Update: =DataCardValue3.Text
                Width: =383
                X: =2
                Y: =0
                ZIndex: =3

                DataCardKey3 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =27
                    PaddingLeft: =0
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue3 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Color: =RGBA(51, 51, 51, 1)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =30
                    HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                    HoverColor: =RGBA(51, 51, 51, 1)
                    HoverFill: =RGBA(255, 255, 255, 1)
                    Mode: =TextMode.MultiLine
                    PaddingLeft: =5
                    PressedBorderColor: =RGBA(105, 121, 126, 1)
                    PressedColor: =RGBA(51, 51, 51, 1)
                    PressedFill: =RGBA(255, 255, 255, 1)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey3.Y + DataCardKey3.Height + 5
                    ZIndex: =2

                ErrorMessage3 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue3.Y + DataCardValue3.Height
                    ZIndex: =3

                StarVisible3 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey3.Height
                    PaddingLeft: =0
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey3.Y
                    ZIndex: =4

            "'Business Owner_DataCard1' As typedDataCard.textualEditCard":
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cat_businessowner"
                Default: =ThisItem.'Business Owner'
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Business Owner"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =83
                MaxLength: =DataSourceInfo([@'Business Approval Processes'], DataSourceInfo.MaxLength, "cat_businessowner")
                Required: =false
                Update: |-
                    =First(PeoplePicker1.SelectedPeople).PersonaName
                    //cboBusinessOwner.Selected.DisplayName
                Width: =383
                X: =0
                Y: =1
                ZIndex: =3

                DataCardKey4 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =30
                    PaddingLeft: =0
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                ErrorMessage4 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =13
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =PeoplePicker1.Y + PeoplePicker1.Height
                    ZIndex: =3

                StarVisible4 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey4.Height
                    PaddingLeft: =0
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey4.Y
                    ZIndex: =4

                "PeoplePicker1 As 'Fluent PeoplePicker (1.0.22) Preview'.pcfdataset":
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    Items: |-
                        =If(!IsBlank(_selectedProcess.'Business Owner Email'),
                            AddColumns(
                                Office365Users.SearchUser({searchTerm: _selectedProcess.'Business Owner Email', top:1}),
                                "PersonaKey", Mail, 
                                "PersonaName", DisplayName,
                                "PersonaRole", JobTitle)
                        )
                    MaxPeople: =1
                    OnSearch: |-
                        =ClearCollect(
                            UserCollection,
                            AddColumns(
                            Office365Users.SearchUser({ searchTerm: Self.SearchText, top: 500 }),
                            "SuggestionKey", Mail, 
                            "SuggestionName", DisplayName,
                            "SuggestionRole", JobTitle
                        )
                        )
                    Suggestions_Items: =UserCollection
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =42
                    ZIndex: =6

            "'Secondary Owner_DataCard1' As typedDataCard.textualEditCard":
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cat_secondaryowner"
                Default: =ThisItem.'Secondary Owner'
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Secondary Owner"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =83
                MaxLength: =DataSourceInfo([@'Business Approval Processes'], DataSourceInfo.MaxLength, "cat_secondaryowner")
                Required: =false
                Update: =First(PeoplePicker2.SelectedPeople).PersonaName
                Width: =383
                X: =1
                Y: =1
                ZIndex: =3

                DataCardKey5 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =30
                    PaddingLeft: =0
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                ErrorMessage5 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(168, 0, 0, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =9
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =PeoplePicker2.Y + PeoplePicker2.Height
                    ZIndex: =3

                StarVisible5 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =DataCardKey5.Height
                    PaddingLeft: =0
                    Size: =13
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey5.Y
                    ZIndex: =4

                "PeoplePicker2 As 'Fluent PeoplePicker (1.0.22) Preview'.pcfdataset":
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    Items: |-
                        =If(!IsBlank(_selectedProcess.'Secondary Owner Email'),
                            AddColumns(
                                Office365Users.SearchUser({searchTerm: _selectedProcess.'Secondary Owner Email', top:1}),
                                "PersonaKey", Mail, 
                                "PersonaName", DisplayName,
                                "PersonaRole", JobTitle)
                        )
                    MaxPeople: =1
                    OnSearch: |-
                        =ClearCollect(
                            UserCollection,
                            AddColumns(
                            Office365Users.SearchUser({ searchTerm: Self.SearchText, top: 500 }),
                            "SuggestionKey", Mail, 
                            "SuggestionName", DisplayName,
                            "SuggestionRole", JobTitle
                        )
                        )
                    Suggestions_Items: =UserCollection
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =40
                    ZIndex: =6

            "'Modified On_DataCard1' As typedDataCard.textualViewCard":
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="modifiedon"
                Default: |-
                    =Text(ThisItem.'Modified On', "dd mmm yyyy hh:mm AM/PM")
                DisplayMode: =DisplayMode.View
                DisplayName: ="Modified On"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =40
                Required: =false
                Visible: =Parent.Mode <> FormMode.New
                Width: =383
                X: =0
                Y: =2
                ZIndex: =3

                DataCardKey6 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    PaddingLeft: =0
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue6 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =27
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: =Parent.Default
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey6.Y + DataCardKey6.Height + 5
                    ZIndex: =2

            "'Created On_DataCard1' As typedDataCard.textualViewCard":
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="createdon"
                Default: |-
                    =Text(ThisItem.'Created On', "dd mmm yyyy hh:mm AM/PM")
                DisplayMode: =DisplayMode.View
                DisplayName: ="Created On"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =40
                Required: =false
                Visible: =Parent.Mode <> FormMode.New
                Width: =383
                X: =1
                Y: =2
                ZIndex: =3

                DataCardKey7 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =34
                    PaddingLeft: =0
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue7 As label:
                    AutoHeight: =true
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisplayMode: =Parent.DisplayMode
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =27
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: =Parent.Default
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey7.Y + DataCardKey7.Height + 5
                    ZIndex: =2

        lblAppDataHeader As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =30
            PaddingLeft: =0
            Size: =10
            Text: ="Application Data"
            Width: =Parent.Width - Self.X - 20
            Wrap: =false
            X: =30
            Y: =frmProcess.Y + frmProcess.Height + 10
            ZIndex: =2

        lblProcessNotSaved As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(255, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =If(Self.Visible, 30, 0)
            PaddingLeft: =0
            Size: =10
            Text: ="Click 'Save' to save the new process before adding Application Data definitions."
            Visible: =IsBlank(_selectedProcess)
            Width: =lblAppDataHeader.Width
            Wrap: =false
            X: =lblAppDataHeader.X
            Y: =lblAppDataHeader.Y + lblAppDataHeader.Height
            ZIndex: =3

        lblAppDataDescription As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =0
            Size: =10
            Text: ="Define input data from consuming application that will be used for approval conditions."
            Width: =lblAppDataHeader.Width
            Wrap: =false
            X: =lblProcessNotSaved.X
            Y: =lblProcessNotSaved.Y + lblProcessNotSaved.Height
            ZIndex: =4

        TableHeader_3 As TableHeader:
            ColumnOnClick: ="Text"
            Columns: |-
                =Table(
                    { Index: 1, Text: "Field Name", Column: "cat_name", Width: 250, Offset: 0, EnableSort: true },    
                    { Index: 2, Text: "Data Type", Column: "cat_datatype", Width: 180, Offset: 0, EnableSort: true },
                    { Index: 3, Text: "Default Value", Column: "cat_defaultvalue", Width: 180, Offset: -70, EnableSort: false },
                    { Index: 3, Text: "Description", Column: "cat_description", Width: 250, Offset: -140, EnableSort: false }
                )
            Width: =Max(Parent.Width - Self.X - 30, 920)
            X: =lblAppDataHeader.X
            Y: =lblAppDataDescription.Y + lblAppDataDescription.Height
            ZIndex: =5

        txtAppDataName As text:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =varAppDataItem.Name
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: =If(lblProcessNotSaved.Visible, DisplayMode.Disabled, DisplayMode.Edit)
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =30
            HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PaddingLeft: =5
            PressedBorderColor: =RGBA(0, 120, 212, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Width: =246
            X: =lblAppDataHeader.X
            Y: =TableHeader_3.Y + TableHeader_3.Height + 2
            ZIndex: =6

        ddlDataType As dropdown:
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =1
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =varAppDataItem.'Data Type'
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: =txtAppDataName.DisplayMode
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =30
            HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: =Choices('Business Approval Data Type')
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(0, 120, 212, 1)
            SelectionFill: =RGBA(0, 120, 212, 1)
            Size: =10
            Width: =178
            X: =txtAppDataName.X + txtAppDataName.Width + 6
            Y: =txtAppDataName.Y
            ZIndex: =7

        txtAppDataDefault As text:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =varAppDataItem.'Default Value'
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: =txtAppDataName.DisplayMode
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Format: =If(ddlDataType.Selected.Value = 'Business Approval Data Type'.Number, TextFormat.Number, TextFormat.Text)
            Height: =30
            HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PaddingLeft: =5
            PressedBorderColor: =RGBA(0, 120, 212, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Width: =178
            X: =ddlDataType.X + ddlDataType.Width + 6
            Y: =TableHeader_3.Y + TableHeader_3.Height + 2
            ZIndex: =8

        dtAppDataDefault As datepicker:
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =1
            CalendarHeaderFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            Color: =RGBA(51, 51, 51, 1)
            DefaultDate: =If(isDefaultDataClear, Blank(), varAppDataItem.'Default Value')
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Format: ="dd mmm yyyy"
            Height: =txtAppDataDefault.Height
            HoverDateFill: =RGBA(200, 200, 200, 1)
            IconBackground: =RGBA(105, 121, 126, 1)
            PaddingTop: =5
            SelectedDateFill: =RGBA(105, 121, 126, 1)
            Size: =10
            Visible: =ddlDataType.Selected.Value = 'Business Approval Data Type'.Date
            Width: =txtAppDataDefault.Width - If(!IsBlank(varAppDataItem.'Default Value'), 30, 0)
            X: =txtAppDataDefault.X
            Y: =txtAppDataDefault.Y
            ZIndex: =9

        ddlAppDataDefault As dropdown:
            AllowEmptySelection: =true
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =1
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =varAppDataItem.'Default Value'
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =txtAppDataDefault.Height
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: =[ "", "True", "False" ]
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SelectionFill: =RGBA(105, 121, 126, 1)
            Size: =10
            Visible: =ddlDataType.Selected.Value = 'Business Approval Data Type'.Boolean
            Width: =txtAppDataDefault.Width
            X: =txtAppDataDefault.X
            Y: =txtAppDataDefault.Y
            ZIndex: =10

        icoClearDefault As icon.Cancel:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(105, 121, 126, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =dtAppDataDefault.Height
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({ isDefaultDataClear: true })
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =8
            PaddingTop: =8
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Tooltip: ="Clear default"
            Visible: =dtAppDataDefault.Visible && !IsBlank(varAppDataItem)
            Width: =Self.Height
            X: =txtAppDataDefault.X + txtAppDataDefault.Width - Self.Width
            Y: =dtAppDataDefault.Y
            ZIndex: =11

        txtAppDataDesc As text:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =varAppDataItem.Description
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: =txtAppDataName.DisplayMode
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =30
            HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PaddingLeft: =5
            PressedBorderColor: =RGBA(0, 120, 212, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Width: =248
            X: =txtAppDataDefault.X + txtAppDataDefault.Width + 6
            Y: =TableHeader_3.Y + TableHeader_3.Height + 2
            ZIndex: =12

        btnSaveAppData As button:
            BorderColor: =RGBA(225, 223, 221, 1)
            BorderThickness: =1
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: =If(IsBlank(txtAppDataName.Text), DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =RGBA(243, 242, 241, 1)
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =30
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(225, 223, 221, 1)
            OnSelect: |-
                =Patch(
                    'Business Approval Data', 
                    If(IsBlank(varAppDataItem), Defaults('Business Approval Data'), varAppDataItem),
                    { 
                        Name: txtAppDataName.Text, 'Data Type': ddlDataType.Selected.Value, 
                        'Default Value': 
                            Switch(ddlDataType.Selected.Value,
                                'Business Approval Data Type'.Boolean, ddlAppDataDefault.Selected.Value,
                                'Business Approval Data Type'.Date, Text(dtAppDataDefault.SelectedDate, "dd mmm yyyy"), 
                                txtAppDataDefault.Text
                            ), 
                        Description: txtAppDataDesc.Text,
                        Process: _selectedProcess
                    }
                );
                
                UpdateContext({ varAppDataItem: Blank(), isDefaultDataClear: false });
                Reset(txtAppDataName);Reset(ddlDataType);Reset(txtAppDataDefault);Reset(txtAppDataDesc)
            PressedBorderColor: =Self.BorderColor
            PressedColor: =Self.Color
            PressedFill: =Self.HoverFill
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Text: =If(IsBlank(varAppDataItem), "+ Add", "Update")
            Width: =80
            X: =txtAppDataDesc.X + txtAppDataDesc.Width + 8
            Y: =txtAppDataName.Y
            ZIndex: =13

        btnCancelEditData As button:
            BorderColor: =RGBA(225, 223, 221, 1)
            BorderThickness: =1
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(243, 242, 241, 1)
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =30
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(225, 223, 221, 1)
            OnSelect: |-
                =UpdateContext({ varAppDataItem: Blank(), isDefaultDataClear: false })
            PressedBorderColor: =Self.BorderColor
            PressedColor: =Self.Color
            PressedFill: =Self.HoverFill
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Text: ="Cancel"
            Tooltip: ="Cancel update"
            Visible: =!IsBlank(varAppDataItem)
            Width: =80
            X: =btnSaveAppData.X + btnSaveAppData.Width + 8
            Y: =txtAppDataName.Y
            ZIndex: =14

        galAppRequestData As gallery.galleryVertical:
            BorderColor: =RGBA(166, 166, 166, 1)
            Height: =Parent.Height - Self.Y - 20
            Items: |-
                =Filter(
                    Filter('Business Approval Data', 'Business Approval Data (Views)'.'Active Business Approval Data'),
                    Process.'Business Approval Process' = _selectedProcess.'Business Approval Process'
                )
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =32
            Width: =TableHeader_3.Width
            X: =txtAppDataName.X
            Y: =txtAppDataName.Y + txtAppDataName.Height + 4
            ZIndex: =15

            lblAppDataName As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(243, 242, 241, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =30
                OnSelect: =Select(Parent)
                Size: =10
                Text: =ThisItem.Name
                Width: =246
                ZIndex: =1

            lblAppDataType As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(243, 242, 241, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =30
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Size: =10
                Text: =ThisItem.'Data Type'
                Width: =178
                X: =lblAppDataName.X + lblAppDataName.Width + 6
                ZIndex: =2

            lblAppDataDefault As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(243, 242, 241, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =30
                OnSelect: =Select(Parent)
                Size: =10
                Text: =ThisItem.'Default Value'
                Width: =178
                X: =lblAppDataType.X + lblAppDataType.Width + 6
                ZIndex: =3

            lblAppDataDesc As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(243, 242, 241, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =30
                OnSelect: =Select(Parent)
                Size: =10
                Text: =ThisItem.Description
                Width: =248
                X: =lblAppDataDefault.X + lblAppDataDefault.Width + 6
                ZIndex: =4

            icoAppDataEdit As icon.Edit:
                BorderColor: =RGBA(166, 166, 166, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =30
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Edit
                OnSelect: |-
                    =UpdateContext({ varAppDataItem: ThisItem })
                PaddingBottom: =6
                PaddingLeft: =6
                PaddingRight: =6
                PaddingTop: =6
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =30
                X: =lblAppDataDesc.X + lblAppDataDesc.Width + 6
                ZIndex: =5

            icoAppDataDelete As icon.Edit:
                BorderColor: =RGBA(166, 166, 166, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =30
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Trash
                OnSelect: |-
                    =Reset(ConfirmDialog_1);
                    UpdateContext({ busyMessage: "Checking dependencies..."});
                    Set(_isBusy, true);
                    Concurrent(
                        ClearCollect(_stDeps,
                            ShowColumns(Filter('Business Approval Stages', 'Source Data'.'Business Approval Data' = ThisItem.'Business Approval Data'), "cat_name")
                        ),
                        ClearCollect(_ndDeps, 
                            ShowColumns(Filter('Business Approval Nodes', 'Source Data'.'Business Approval Data' = ThisItem.'Business Approval Data'), "cat_name")
                        ),
                        UpdateContext({cdDeps: 
                            ShowColumns(
                                Filter('Business Approval Conditions', 'Condition Data'.'Business Approval Data' = ThisItem.'Business Approval Data'),
                                "cat_stagenamevalue", "cat_nodenamevalue"
                            )
                        })
                    );
                    With({ countSt: CountRows(_stDeps), countNd: CountRows(_ndDeps), countCd: CountRows(cdDeps) },
                        If(countSt + countNd + countCd = 0,
                            //confirm deletion
                            UpdateContext({ 
                                varAppDataItem: ThisItem, confirmMode: "DeleteAppData",
                                confirmMessage: "This will delete Application Data field '" & ThisItem.Name & "'. Are you sure?" 
                            }),
                    
                            //show dependencies    
                            ForAll(cdDeps, 
                                If(!IsBlank(cat_stagenamevalue), 
                                    Collect(_stDeps, { cat_name: cat_stagenamevalue }), 
                                    If(!IsBlank(cat_nodenamevalue), Collect(_ndDeps, { cat_name: cat_nodenamevalue }))
                                )
                            );    
                            UpdateContext({ 
                                confirmMode: "AckDeps",
                                confirmMessage: "This field cannot be deleted because of the following dependencies: " & Char(10) &
                                    If(!IsEmpty(_stDeps), Char(10) & "Stages: " & Concat(_stDeps, cat_name, ", ")) &
                                    If(!IsEmpty(_ndDeps), Char(10) & "Nodes: " & Concat(_ndDeps, cat_name, ", "))
                            })
                        )
                    );
                    Set(_isBusy, false); Set(_showConfirm, true)
                PaddingBottom: =6
                PaddingLeft: =6
                PaddingRight: =6
                PaddingTop: =6
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =30
                X: =icoAppDataEdit.X + icoAppDataEdit.Width + 6
                Y: =2
                ZIndex: =6

        ConfirmDialog_1 As ConfirmDialog:
            ConfirmText: =confirmMessage
            Height: =Parent.Height
            OkOnly: =confirmMode = "AckDeps"
            OnClick: |-
                =If(IsConfirmed,
                    Switch(confirmMode,
                        "Deactivate",
                            UpdateContext({ busyMessage: "Deactivating process " & _selectedProcess.Name });
                            Set(_isBusy, true);
                            Patch('Business Approval Processes', _selectedProcess, { Status: 'Status (Business Approval Processes)'.Inactive });   
                            Set(_selectedProcess, Blank()); 
                            Set(_isBusy, false);
                            Navigate('Business Approval Processes (Views)'.'Active Business Approval Processes'),
                
                        "DeleteAppData",
                            UpdateContext({ busyMessage: "Deleting app data field " & varAppDataItem.Name });
                            Set(_isBusy, true);
                            Remove('Business Approval Data', varAppDataItem);
                            UpdateContext({ varAppDataItem: Blank() });
                            Set(_isBusy, false),
                        
                        "AckDeps",
                            //clear all placeholder collections
                            Clear(_stDeps);Clear(_ndDeps)
                    )
                );
                Set(_showConfirm, false);
            Visible: =_showConfirm
            Width: =Parent.Width
            ZIndex: =16

        "CommandBar2_4 As 'Fluent Command Bar (1.0.22)'.pcfdataset":
            DisplayMode: =DisplayMode.Edit
            Height: =40
            Items: |-
                =Table(
                    {
                        ItemKey: "save",
                        ItemDisplayName: "Save",
                        ItemIconName: "Save"
                    },{
                        ItemKey: "workflow",
                        ItemDisplayName: "Workflow",
                        ItemIconName: "WorkFlow"
                    },{
                        ItemKey: "deactivate",
                        ItemDisplayName: "Deactivate",
                        ItemIconName: "EntryDecline"
                    },{
                        ItemKey: "versions",
                        ItemDisplayName: "Versions",
                        ItemIconName: "DependencyAdd"
                    }
                )
            OnSelect: |-
                =Switch(Self.Selected.ItemKey, 
                    "save", 
                        Set(_isBusy, true);
                        SubmitForm(frmProcess),
                    "workflow",
                        Navigate(scrWorkflowEditor),
                    "versions",
                        Navigate(scrProcessVersion),
                    "deactivate",
                        UpdateContext({ 
                            confirmMode: "Deactivate",
                            confirmMessage: "This will deactivate the Process and its related Application Data, Approval Stages, Stage Conditions and Nodes. 
                Deactivated items will be automatically removed after 30 days. 
                Are you sure?"});
                        Set(_showConfirm, true)
                )
            Theme: =AppThemeJson
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =17

        BusyScreen_1 As BusyScreen:
            BusyMessage: =busyMessage
            Fill: =RGBA(255, 255, 255, 0.8)
            Height: =Parent.Height
            Visible: =_isBusy
            Width: =Parent.Width
            ZIndex: =18

    Button2 As Button:
        BorderColor: =
        DisabledBorderColor: =
        DisabledFillColor: =
        DisabledTextColor: =
        DisplayMode: =DisplayMode.Edit
        FillColor: =
        Height: =32
        HoverBorderColor: =
        HoverFillColor: =
        HoverTextColor: =
        OnChange: =false
        OnSelect: |-
            =//Passing record ID from main view
                Set(_selectedProcess,
             LookUp(
                        'Business Approval Processes',
                        'Business Approval Process' = GUID("a24bac16-cfb1-ed11-83fe-0022482a97de")
                    ) 
                );
                EditForm(frmProcess)
        PressedBorderColor: =
        PressedFillColor: =
        PressedTextColor: =
        TextColor: =
        Visible: =false
        Width: =96
        X: =1270
        Y: =0
        ZIndex: =2

