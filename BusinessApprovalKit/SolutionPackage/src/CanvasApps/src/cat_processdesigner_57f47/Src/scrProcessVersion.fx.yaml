scrProcessVersion As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |-
        =Refresh('Business Approval Versions');
        ClearCollect(_colPublishedVersions, 
            Filter(
                Filter('Business Approval Versions', 'Business Approval Versions (Views)'.'All Versions'),
                Process.'Business Approval Process' = _selectedProcess.'Business Approval Process'
            )
        )

    Container1_11 As groupContainer:
        Height: =Parent.Height - Self.Y
        Width: =Parent.Width - Self.X
        ZIndex: =1

        "CommandBar2_3 As 'Fluent Command Bar (1.1.29)'.pcfdataset":
            DisplayMode: =DisplayMode.Edit
            Height: =40
            Items: |-
                =Table(
                    {
                        ItemKey: "back",
                        ItemDisplayName: "Back",
                        ItemIconName: "NavigateBack"
                    },{
                        ItemKey: "process",
                        ItemDisplayName: "Process",
                        ItemIconName: "Flowchart"
                    },{
                        ItemKey: "workflow",
                        ItemDisplayName: "Workflow",
                        ItemIconName: "WorkFlow"
                    },{
                        ItemKey: "refresh",
                        ItemDisplayName: "Refresh",
                        ItemIconName: "Refresh"
                    }
                )
            OnSelect: |-
                =Switch(Self.Selected.ItemKey, 
                    "back",
                        Back(),
                    "workflow",
                        Navigate(scrWorkflowEditor),
                    "process",
                        Navigate(scrProcessEditor),
                    "refresh",
                        Refresh('Business Approval Versions');
                        ClearCollect(_colPublishedVersions, 
                        Filter(
                            Filter('Business Approval Versions', 'Business Approval Versions (Views)'.'All Versions'),
                            Process.'Business Approval Process' = _selectedProcess.'Business Approval Process'
                        )
                    )
                )
            Theme: =AppThemeJson
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =1

        galProcessVersion As gallery.galleryVertical:
            '#CopilotOverlayLabel': ="Filtered"
            BorderColor: =RGBA(166, 166, 166, 1)
            DelayItemLoading: =true
            FocusedBorderThickness: =2
            Height: =CountRows(Self.AllItems) * (Self.TemplateHeight + 2 * Self.TemplatePadding)
            Items: =_colPublishedVersions
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplateSize: =40
            Visible: =CountRows(Self.AllItems) > 0
            Width: =TableHeader_2.Width
            X: =TableHeader_2.X
            Y: =TableHeader_2.Y + TableHeader_2.Height
            ZIndex: =2

            Rectangle4_1 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisplayMode: =DisplayMode.Disabled
                Fill: =RGBA(230, 230, 230, 1)
                FocusedBorderThickness: =4
                Height: =1
                HoverFill: =RGBA(105, 121, 126, 1)
                OnSelect: =Select(Parent)
                PressedFill: =RGBA(105, 121, 126, 1)
                Width: =Parent.TemplateWidth - 5
                Y: =Parent.TemplateHeight - 1
                ZIndex: =1

            lblVersionNo As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Size: =10
                Text: =ThisItem.Version
                Width: =60
                ZIndex: =2

            lblVersionCreatedBy As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Size: =10
                Text: =ThisItem.'Created By'.'Full Name'
                Width: =250
                Wrap: =false
                X: =92
                ZIndex: =3

            lblVersionCreated As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Size: =10
                Text: |-
                    =Text(ThisItem.'Created On', "dd mmm yyyy hh:mm AM/PM")
                Width: =200
                Wrap: =false
                X: =lblVersionCreatedBy.X + lblVersionCreatedBy.Width
                ZIndex: =4

            lblVersionPubStatus As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Size: =10
                Text: =ThisItem.'Publishing Status'
                Wrap: =false
                X: =lblVersionCreated.X + lblVersionCreated.Width
                ZIndex: =5

            lblVersionStatus As label:
                Align: =Align.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =If(ThisItem.Status = 'Status (Business Approval Versions)'.Active, RGBA(255, 255, 255, 1), RGBA(0, 0, 0, 1))
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Fill: =If(ThisItem.Status = 'Status (Business Approval Versions)'.Active, RGBA(54, 176, 75, 1), RGBA(54, 176, 75, 0))
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Parent.TemplateHeight - 10
                OnSelect: =Select(Parent)
                Size: =10
                Text: =ThisItem.Status
                Visible: =icoViewRuntimeProcess.Visible
                Width: =90
                Wrap: =false
                X: =lblVersionPubStatus.X + lblVersionPubStatus.Width + 10
                Y: =Parent.TemplateHeight / 2 - Self.Height / 2
                ZIndex: =6

            icoRefreshPubStatus As icon.Edit:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =Parent.TemplateHeight
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Reload
                OnSelect: =Refresh('Business Approval Versions')
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =Self.Height
                X: =lblVersionStatus.X + lblVersionStatus.Width + 5
                ZIndex: =7

            icoViewRuntimeProcess As icon.DetailList:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =icoRefreshPubStatus.Height
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Information
                OnSelect: =Set(_selectedProcessVersion, ThisItem);Navigate(scrRuntimeProcessView)
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Visible: =ThisItem.'Publishing Status' = 'Business Approval Publishing Status'.Published
                Width: =icoRefreshPubStatus.Width
                X: =icoRefreshPubStatus.X+ icoRefreshPubStatus.Width
                Y: =icoRefreshPubStatus.Y
                ZIndex: =8

            icoViewApprovalVersion As icon.DetailList:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =icoRefreshPubStatus.Height
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.LevelsLayersItems
                OnSelect: =Set(_selectedProcessVersion, ThisItem);//Navigate(scrRuntimeWorkflowView)
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Visible: =ThisItem.'Publishing Status' = 'Business Approval Publishing Status'.Published
                Width: =icoRefreshPubStatus.Width
                X: =icoViewRuntimeProcess.X+ icoViewRuntimeProcess.Width
                Y: =icoRefreshPubStatus.Y
                ZIndex: =9

            btnActivate As button:
                BorderColor: =RGBA(0, 0, 0, 0)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(105, 121, 126, 1)
                FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                Font: =Font.'Segoe UI'
                Height: =30
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
                OnSelect: |-
                    =//deactivate all other versions and activate current selection
                    ForAll(_colPublishedVersions, 
                        UpdateIf('Business Approval Versions', 'Business Approval Version' = ThisRecord.'Business Approval Version',
                            { Status: 
                                If('Business Approval Version' = ThisItem.'Business Approval Version', 
                                'Status (Business Approval Versions)'.Active, 'Status (Business Approval Versions)'.Inactive)
                            }
                        )
                    );
                    Select(btnRefreshPublishedVersions)
                PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Text: ="Activate"
                Visible: =ThisItem.Status = 'Status (Business Approval Versions)'.Inactive
                Width: =100
                X: =icoViewApprovalVersion.X + icoViewApprovalVersion.Width + 10
                Y: =lblVersionStatus.Y
                ZIndex: =10

        Label6_1 As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            PaddingLeft: =12
            Size: =10
            Text: ="Published versions for " & _selectedProcess.Name
            Width: =Parent.Width
            Y: =CommandBar2_3.Height
            ZIndex: =3

        btnRefreshPublishedVersions As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =1
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |-
                =Refresh('Business Approval Versions');
                ClearCollect(_colPublishedVersions, 
                    Filter(
                        Filter('Business Approval Versions', 'Business Approval Versions (Views)'.'All Versions'),
                        Process.'Business Approval Process' = _selectedProcess.'Business Approval Process'
                    )
                )
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: =""
            Visible: =false
            Width: =1
            ZIndex: =4

        TableHeader_2 As TableHeader:
            ColumnOnClick: ="Text"
            Columns: |-
                =Table(
                    { Index: 1, Text: "Version", Column: "cat_version", Width: 60, Offset: 0, EnableSort: false },    
                    { Index: 2, Text: "Created By", Column: "Createdby", Width: 250, Offset: -150, EnableSort: false },
                    { Index: 3, Text: "Created On", Column: "Createdon", Width: 250, Offset: -150, EnableSort: true },
                    { Index: 4, Text: "Publishing Status", Column: "cat_publishingstatus", Width: 120, Offset: -202, EnableSort: false },
                    { Index: 5, Text: "Activation Status", Column: "status", Width: 120, Offset: -305, EnableSort: false }
                )
            EnableSort: =false
            Width: =Parent.Width - 50
            X: =20
            Y: =Label6_1.Y + Label6_1.Height
            ZIndex: =5

        Label6_2 As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Size: =10
            Text: ="No published version found."
            Visible: =!galProcessVersion.Visible
            Width: =Parent.Width - Self.X
            X: =galProcessVersion.X
            Y: =galProcessVersion.Y
            ZIndex: =6

