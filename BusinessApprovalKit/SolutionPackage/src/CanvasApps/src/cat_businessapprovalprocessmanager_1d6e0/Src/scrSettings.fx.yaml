scrSettings As screen:
    LoadingSpinnerColor: =RGBA(105, 121, 126, 1)
    OnVisible: |-
        =If(IsBlank(_myUPN), Set(_myUPN, Office365Users.MyProfileV2({'$select':"userPrincipalName"}).userPrincipalName));
        Set(_mySettings, LookUp('Business Approvers', 'Approver Id' = _myUPN))

    Container1 As groupContainer:
        Height: =Parent.Height - Self.Y
        Width: =Parent.Width - Self.X
        X: =Menu_8.Width
        Y: =Header_8.Height
        ZIndex: =1

        cboOutOfOffice As checkbox:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            CheckboxBorderColor: =RGBA(102, 102, 102, 1)
            CheckboxSize: =30
            CheckmarkFill: =RGBA(105, 121, 126, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =_mySettings.'Is Out of Office'
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =10
            Text: =If(Self.Value,"Enabled","Disabled")
            X: =305
            Y: =lblOutOfOffice.Y
            ZIndex: =1

        lblOutOfOffice As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: ="Out of Office"
            Width: =lblApprovalDel.Width
            X: =lblSettingsHeading.X
            Y: =lblPreferredNotification.Y + lblPreferredNotification.Height + 10
            ZIndex: =2

        lblSettingsHeading As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =Semibold
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: ="My Settings"
            Width: =Parent.Width - Self.X - 5
            X: =5
            Y: =Toolbar_7.Height
            ZIndex: =3

        lblApprovalDel As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: ="Approval Delegate"
            Width: =300
            X: =lblSettingsHeading.X
            Y: =lblDelegateNote.Y + lblDelegateNote.Height + 10
            ZIndex: =4

        lblApproverDelBackup As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: ="Backup Delegate"
            Width: =lblApprovalDel.Width
            X: =lblSettingsHeading.X
            Y: =lblApprovalDel.Y + lblApprovalDel.Height + 10
            ZIndex: =5

        cboApproverDelegate As combobox:
            BorderColor: =RGBA(166, 166, 166, 1)
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            DefaultSelectedItems: |-
                =With({ delegate: _mySettings.Delegate}, 
                    If(!IsBlank(delegate), Office365Users.SearchUserV2({searchTerm: delegate.'Approver Id', top:1}).value)
                )
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayFields: =["DisplayName","JobTitle"]
            Font: =Font.'Segoe UI'
            Height: =30
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            InputTextPlaceholder: ="Find user"
            Items: |-
                =Office365Users.SearchUserV2({searchTerm:Self.SearchText}).value
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SearchFields: =["DisplayName"]
            SearchItems: |-
                =Search(Office365Users.SearchUserV2({searchTerm:Self.SearchText}).value,cboApproverDelegate.SearchText,"DisplayName")
            SelectionFill: =RGBA(105, 121, 126, 1)
            SelectMultiple: =false
            Size: =10
            Template: =ListItemTemplate.Double
            Width: =350
            X: =lblApprovalDel.X + lblApprovalDel.Width
            Y: =lblApprovalDel.Y
            ZIndex: =6

        cboApproverBackupDelegate As combobox:
            BorderColor: =RGBA(166, 166, 166, 1)
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            DefaultSelectedItems: |-
                =With({ delegate: _mySettings.'Backup Delegate'}, 
                    If(!IsBlank(delegate), Office365Users.SearchUserV2({searchTerm: delegate.'Approver Id', top:1}).value)
                )
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayFields: =["DisplayName","JobTitle"]
            DisplayMode: =If(CountRows(cboApproverDelegate.SelectedItems)=0,DisplayMode.Disabled,DisplayMode.Edit)
            Font: =Font.'Segoe UI'
            Height: =30
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            InputTextPlaceholder: ="Find user"
            Items: |-
                =Office365Users.SearchUserV2({searchTerm:Self.SearchText}).value
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SearchFields: =["DisplayName"]
            SearchItems: |-
                =Search(Office365Users.SearchUserV2({searchTerm:Self.SearchText}).value,cboApproverBackupDelegate.SearchText,"DisplayName")
            SelectionFill: =RGBA(105, 121, 126, 1)
            SelectMultiple: =false
            Size: =10
            Template: =ListItemTemplate.Double
            Width: =cboApproverDelegate.Width
            X: =cboApproverDelegate.X
            Y: =lblApproverDelBackup.Y
            ZIndex: =7

        lblPreferredNotification As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: ="Enable Outlook Notification"
            Width: =lblApprovalDel.Width
            X: =lblSettingsHeading.X
            Y: =lblApproverDelBackup.Y + lblApproverDelBackup.Height + 10
            ZIndex: =8

        ddlPreferredNotification As dropdown:
            BorderColor: =RGBA(166, 166, 166, 1)
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =_mySettings.'Notification Type'
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Font: =Font.'Segoe UI'
            Height: =30
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: =Choices('Business Approver Notification Type')
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SelectionFill: =RGBA(105, 121, 126, 1)
            Size: =10
            Width: =cboApproverDelegate.Width
            X: =cboApproverDelegate.X
            Y: =lblPreferredNotification.Y
            ZIndex: =9

        lblSettingsWorkProfile As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =Semibold
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: ="My Work Profile"
            Width: =Parent.Width - Self.X - 5
            X: =lblSettingsHeading.X
            Y: =lblOutOfOffice.Y + lblOutOfOffice.Height + 30
            ZIndex: =10

        lblSelectProfile As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: ="Select Profile"
            Width: =lblApprovalDel.Width
            X: =lblSettingsHeading.X
            Y: =lblSettingsWorkProfile.Y + lblSettingsWorkProfile.Height + 10
            ZIndex: =11

        ddlWorkProfile As dropdown:
            BorderColor: =RGBA(166, 166, 166, 1)
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =_mySettings.'Work Profile'.Name
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Font: =Font.'Segoe UI'
            Height: =30
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: =Filter('Business Approval Work Profiles', 'Business Approval Work Profiles (Views)'.'Active Business Approval Work Profiles')
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SelectionFill: =RGBA(105, 121, 126, 1)
            Size: =10
            Width: =cboApproverDelegate.Width
            X: =cboApproverDelegate.X
            Y: =lblSettingsWorkProfile.Y
            ZIndex: =12

        btnSun As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =Self.Color
            DisabledFill: =Self.Fill
            DisplayMode: =DisplayMode.Disabled
            Fill: =If(ddlWorkProfile.Selected.Sunday = 'Sunday (Business Approval Work Profiles)'.Yes , RGBA(0, 121, 187, 1), RGBA(105, 121, 126, 1))
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =40
            RadiusBottomRight: =40
            RadiusTopLeft: =40
            RadiusTopRight: =40
            Size: =9
            Text: ="Sun"
            Width: =40
            X: =cboApproverDelegate.X
            Y: =lblSelectProfile.Y
            ZIndex: =13

        btnMon As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =Self.Color
            DisabledFill: =Self.Fill
            DisplayMode: =DisplayMode.Disabled
            Fill: =If(ddlWorkProfile.Selected.Monday = 'Monday (Business Approval Work Profiles)'.Yes , RGBA(0, 121, 187, 1), RGBA(105, 121, 126, 1))
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =40
            RadiusBottomRight: =40
            RadiusTopLeft: =40
            RadiusTopRight: =40
            Size: =9
            Text: ="Mon"
            Width: =40
            X: =btnSun.X + btnSun.Width + 10
            Y: =lblSelectProfile.Y
            ZIndex: =14

        btnTue As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =Self.Color
            DisabledFill: =Self.Fill
            DisplayMode: =DisplayMode.Disabled
            Fill: =If(ddlWorkProfile.Selected.Tuesday = 'Tuesday (Business Approval Work Profiles)'.Yes , RGBA(0, 121, 187, 1), RGBA(105, 121, 126, 1))
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =40
            RadiusBottomRight: =40
            RadiusTopLeft: =40
            RadiusTopRight: =40
            Size: =9
            Text: ="Tue"
            Width: =40
            X: =btnMon.X + btnSun.Width + 10
            Y: =lblSelectProfile.Y
            ZIndex: =15

        btnWed As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =Self.Color
            DisabledFill: =Self.Fill
            DisplayMode: =DisplayMode.Disabled
            Fill: =If(ddlWorkProfile.Selected.Wednesday = 'Wednesday (Business Approval Work Profiles)'.Yes , RGBA(0, 121, 187, 1), RGBA(105, 121, 126, 1))
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =40
            RadiusBottomRight: =40
            RadiusTopLeft: =40
            RadiusTopRight: =40
            Size: =9
            Text: ="Wed"
            Width: =40
            X: =btnTue.X + btnSun.Width + 10
            Y: =lblSelectProfile.Y
            ZIndex: =16

        btnThu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =Self.Color
            DisabledFill: =Self.Fill
            DisplayMode: =DisplayMode.Disabled
            Fill: =If(ddlWorkProfile.Selected.Thursday = 'Thursday (Business Approval Work Profiles)'.Yes , RGBA(0, 121, 187, 1), RGBA(105, 121, 126, 1))
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =40
            RadiusBottomRight: =40
            RadiusTopLeft: =40
            RadiusTopRight: =40
            Size: =9
            Text: ="Thu"
            Width: =40
            X: =btnWed.X + btnSun.Width + 10
            Y: =lblSelectProfile.Y
            ZIndex: =17

        btnFri As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =Self.Color
            DisabledFill: =Self.Fill
            DisplayMode: =DisplayMode.Disabled
            Fill: =If(ddlWorkProfile.Selected.Friday = 'Friday (Business Approval Work Profiles)'.Yes , RGBA(0, 121, 187, 1), RGBA(105, 121, 126, 1))
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =40
            RadiusBottomRight: =40
            RadiusTopLeft: =40
            RadiusTopRight: =40
            Size: =9
            Text: ="Fri"
            Width: =40
            X: =btnThu.X + btnSun.Width + 10
            Y: =lblSelectProfile.Y
            ZIndex: =18

        btnSat As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =Self.Color
            DisabledFill: =Self.Fill
            DisplayMode: =DisplayMode.Disabled
            Fill: =If(ddlWorkProfile.Selected.Saturday = 'Saturday (Business Approval Work Profiles)'.Yes , RGBA(0, 121, 187, 1), RGBA(105, 121, 126, 1))
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =40
            RadiusBottomRight: =40
            RadiusTopLeft: =40
            RadiusTopRight: =40
            Size: =9
            Text: ="Sat"
            Width: =40
            X: =btnFri.X + btnSun.Width + 10
            Y: =lblSelectProfile.Y
            ZIndex: =19

        lblHolidayCalendar As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: ="Associated Public Holiday Calendar"
            Width: =lblApprovalDel.Width
            X: =lblSettingsHeading.X
            Y: =btnSun.Y + btnSun.Height + 20
            ZIndex: =20

        lblHolidayCalendarName As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =10
            Text: =ddlWorkProfile.Selected.'Holiday Calendar'.Name
            Width: =cboApproverDelegate.Width
            X: =cboApproverDelegate.X
            Y: =lblHolidayCalendar.Y
            ZIndex: =21

        galPublicHolidays As gallery.galleryVertical:
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =1
            Height: =Min(CountRows(Self.AllItems) * Self.TemplateHeight, Parent.Height - Self.Y - 20)
            Items: |-
                =SortByColumns(
                Filter('Business Approval Public Holidays' As Hols, 
                    Hols.Calendar.'Business Approval Holiday Calendar' = ddlWorkProfile.Selected.'Holiday Calendar'.'Business Approval Holiday Calendar' &&         Hols.Date >= Today()
                ), "cat_date", Ascending)
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =32
            Width: =cboApproverDelegate.Width
            X: =cboApproverDelegate.X
            Y: =lblHolidayCalendarName.Y + lblHolidayCalendarName.Height
            ZIndex: =22

            Label4 As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =30
                OnSelect: =Select(Parent)
                Size: =10
                Text: =Text(ThisItem.Date, "dd mmm yyyy") & " " & ThisItem.Name
                Width: =Parent.TemplateWidth
                ZIndex: =1

        lblDelegateNote As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: ="Delegates cannot be yourself, and the main and backup delegate cannot be the same person."
            Width: =Parent.Width - Self.X - 50
            X: =lblSettingsHeading.X
            Y: =lblSettingsHeading.Y + lblSettingsHeading.Height
            ZIndex: =23

        lblDelegateError As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(255, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: =If(cboApproverDelegate.Selected.UserPrincipalName = _myUPN, "You cannot be your own delegate.")
            Visible: =Len(Self.Text) > 0
            Width: =300
            X: =cboApproverDelegate.X + cboApproverDelegate.Width
            Y: =cboApproverDelegate.Y
            ZIndex: =24

        lblBackupDelegateError As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(255, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =30
            PaddingLeft: =12
            Size: =10
            Text: |-
                =With({ selected: cboApproverBackupDelegate.Selected.UserPrincipalName},
                    If(CountRows(cboApproverDelegate.SelectedItems)>0,
                        If(selected = _myUPN, "You cannot be your own backup delegate.", cboApproverDelegate.Selected.UserPrincipalName = selected, 
                        "Delegates cannot be the same person.")
                    )
                )
            Visible: =Len(Self.Text) > 0
            Width: =300
            X: =lblDelegateError.X
            Y: =cboApproverBackupDelegate.Y
            ZIndex: =25

        Toolbar_7 As Toolbar:
            DisabledItems: =If(lblDelegateError.Visible || lblBackupDelegateError.Visible, [ "Save" ])
            OnClick: |-
                =Switch(MenuItem,
                    "Save",
                    Set(_isBusy, true);
                    //first delegate
                    If(CountRows(cboApproverDelegate.SelectedItems)>0,
                        With({ 
                                del1: LookUp('Business Approvers', 'Approver Id' = cboApproverDelegate.Selected.UserPrincipalName),
                                del2: LookUp('Business Approvers', 'Approver Id' = cboApproverBackupDelegate.Selected.UserPrincipalName)
                            },
                            
                            //save delegates as new approvers if does not exist
                            //first delegate
                            Patch('Business Approvers', Coalesce(_mySettings, Defaults('Business Approvers')),
                            {
                                Delegate: If(IsBlank(del1), Patch('Business Approvers', Defaults('Business Approvers'), 
                                    {
                                        'Approver Id': cboApproverDelegate.Selected.UserPrincipalName,
                                        Name: cboApproverDelegate.Selected.DisplayName, 'Approver Type': 'Business Approver Type'.User
                                    }), del1
                                ),
                                'Backup Delegate': If(CountRows(cboApproverBackupDelegate.SelectedItems)>0,
                                    If(IsBlank(del2), Patch('Business Approvers', Defaults('Business Approvers'), 
                                        {
                                            'Approver Id': cboApproverBackupDelegate.Selected.UserPrincipalName,
                                            Name: cboApproverBackupDelegate.Selected.DisplayName, 'Approver Type': 'Business Approver Type'.User
                                        }), del2
                                    ),Blank()
                                ),
                                'Notification Type': ddlPreferredNotification.Selected.Value, 'Work Profile': ddlWorkProfile.Selected,
                                'Approver Type': 'Business Approver Type'.User,
                                'Is Out of Office':cboOutOfOffice.Value
                            });
                        )
                    );
                    //error check
                    If(
                        !IsEmpty(Errors('Business Approvers')),
                        Notify(Concat(Errors('Business Approvers'), Column&": "&Message),
                            NotificationType.Error
                        ),
                        Notify("Settings saved successfully.", 
                        NotificationType.Success
                        )
                    );    
                    Set(_isBusy, false),
                    "Reset",
                    Set(_mySettings, LookUp('Business Approvers', 'Approver Id' = _myUPN));
                    Reset(cboApproverBackupDelegate);Reset(cboApproverDelegate);Reset(ddlPreferredNotification);Reset(ddlWorkProfile);Reset(cboOutOfOffice)
                )
            ToolbarItems: |-
                =Table({ Icon: Icon.Save, Text: "Save", Offset: 0 },{Icon: Icon.Reset, Text: "Reset", Offset: -60 })
            Width: =Parent.Width
            ZIndex: =26

        BusyScreen_5 As BusyScreen:
            BusyMessage: ="Saving..."
            Fill: =RGBA(255, 255, 255, 0.8)
            Height: =Parent.Height
            Visible: =_isBusy
            Width: =Parent.Width
            ZIndex: =27

        Label8 As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =0
            Size: =13
            Text: =_mySettings.Delegate.'Display Name'
            Visible: =false
            Width: =0
            ZIndex: =28

    Image1_7 As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =Menu_8.Height
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =gradient_top
        ImagePosition: =ImagePosition.Stretch
        ImageRotation: =ImageRotation.Rotate90
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =4
        X: =Menu_8.Width
        Y: =Menu_8.Y
        ZIndex: =2

    Menu_8 As Menu:
        Height: =Parent.Height - Self.Y
        MenuItems: =_menu
        OnHamburgerClick: =Set(_hideMenu, !_hideMenu)
        Width: =If(_hideMenu, 45, 200)
        Y: =Header_8.Height
        ZIndex: =3

    Header_8 As Header:
        Height: =60
        ShowRefresh: =false
        Title: =_appConfig.Title
        Width: =Parent.Width
        ZIndex: =4

