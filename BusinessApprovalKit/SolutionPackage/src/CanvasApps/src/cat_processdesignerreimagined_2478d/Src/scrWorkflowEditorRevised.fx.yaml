"scrWorkflowEditorRevised As screen.'autoLayout_HeaderFooter_ver1.0'":
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)

    ScreenContainer1 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Fill: =RGBA(245, 245, 245, 1)
        Height: =Parent.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =16
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =16
        PaddingLeft: =16
        PaddingRight: =16
        PaddingTop: =16
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =Parent.Width
        ZIndex: =1

        HeaderContainer1 As groupContainer.horizontalAutoLayoutContainer:
            DropShadow: =DropShadow.Light
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            Height: =50
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            ZIndex: =2

            "ckMainCommandBar As 'Fluent Command Bar (1.0.22)'.pcfdataset":
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =40
                Items: |-
                    =Table(
                        {
                            ItemKey: "new",
                            ItemDisplayName: "New Stage",
                            ItemIconName: "Add"
                        },{
                            ItemKey: "process",
                            ItemDisplayName: "Process",
                            ItemIconName: "Flowchart"
                        },{
                            ItemKey: "versions",
                            ItemDisplayName: "Versions",
                            ItemIconName: "DependencyAdd"
                        },{
                            ItemKey: "publish",
                            ItemDisplayName: "Publish",
                            ItemIconName: "PublishContent"
                        }
                    )
                LayoutMinHeight: =200
                LayoutMinWidth: =200
                OnSelect: |-
                    =Switch(Self.Selected.ItemKey,
                        "new", 
                            Set(_selectedStage, Blank()); 
                            Set(_currentStageIndex, ApprovalDesignerEdit_1.TotalStages + 1);
                            Navigate(scrWizardStageEditor),
                        "process", Navigate(scrWizardProcessEditor),
                        "versions", Navigate(scrWizardProcessVersion),
                        "publish", Navigate(scrWizardPublishProcess)
                    )
                Theme: =AppThemeJson
                Width: =200
                X: =0
                Y: =155
                ZIndex: =1

        MainContainer1 As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.Light
            Fill: =RGBA(255, 255, 255, 1)
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            ZIndex: =3

            ApprovalDesignerEdit_2 As ApprovalDesigner:
                AddNode: |-
                    =Set(_selectedNode, Blank());
                    Set(_selectedStage, LookUp('Business Approval Stages', 'Business Approval Stage' = GUID(StageId)));
                    Set(_currentStageIndex, StageIndex);
                    Set(_currentNodeIndex, Row);
                    Set(_currentPathIndex, Path);
                    Navigate(scrWizardNodeEditor)
                EditNode: |
                    =Concurrent(
                        Set(_selectedNode, LookUp('Business Approval Nodes', 'Business Approval Node' = GUID(NodeId))),
                        Set(_selectedStage, LookUp('Business Approval Stages', 'Business Approval Stage' = GUID(StageId)))
                    );
                    Set(_currentNodeIndex, _selectedNode.'Row Index');
                    Set(_currentPathIndex, _selectedNode.'Path Index');
                    Set(_currentStageIndex, _selectedStage.Order);
                    If(_selectedNode.'Node Condition' = 'Business Approval Stage Condition'.None && IsBlank(_selectedNode.'Go To Stage'),
                        Navigate(scrWizardNodeEditor),
                        Navigate(scrWizardNodeRule)
                    )
                EditStage: |-
                    =Set(_selectedStage, LookUp('Business Approval Stages', 'Business Approval Stage' = GUID(StageId)));
                    Set(_currentStageIndex, _selectedStage.Order);
                    Navigate(scrWizardStageEditor)
                Height: =Parent.Height - Self.Y
                LayoutMinHeight: =640
                LayoutMinWidth: =640
                MoveStage: |-
                    =With({ currentStage: LookUp('Business Approval Stages', 'Business Approval Stage' = GUID(StageId))},
                        UpdateContext({ swapOrder: If(IsMoveUp, currentStage.Order - 1, currentStage.Order + 1)});
                        UpdateIf('Business Approval Stages', 
                            Order = swapOrder && Process.'Business Approval Process' = currentStage.Process.'Business Approval Process', 
                            { Order: currentStage.Order }
                        );
                        Patch('Business Approval Stages', currentStage, { Order: If(IsMoveUp, currentStage.Order - 1, currentStage.Order + 1) }) 
                    )
                ProcessId: =_selectedProcess.'Business Approval Process'
                Width: =Parent.Width 
                Y: =70

